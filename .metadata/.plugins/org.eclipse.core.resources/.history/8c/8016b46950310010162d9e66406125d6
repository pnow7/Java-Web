<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ page import="tb_api.*, tb_api.TbDTO.*, java.util.List" %>
<%
    // 로직 구현
    List<TbDTO.Item> items = null;
    
    String serviceKey = "meXac76uoVH%2B6SQfe83GH07q8hu5R%2BTj8AH0alKd3ITyDxlBz22mzP6iGhWjHv0oBAd27SsgtxmVB1RkoFT9sw%3D%3D";
    String srcUrl = "https://apis.data.go.kr/6410000/buslocationservice/v2/getBusLocationListv2";
    
    try {
        
        Class<TbDTO> dto = TbDTO.class;
        TbDTO data = (TbDTO)ApiExplorer.getApiJsonData(serviceKey, srcUrl, dto);
        
        if (data.getResponse().getBody().getItems().size() > 0) {
            items = data.getResponse().getBody().getItems();
        }        
                
    } catch(Exception e) {
        System.out.println(e.getMessage());
    }
    
    
%>    
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>관광 표준 데이터</title>
</head>

<body>
<% if (items != null && !items.isEmpty()) { %>
    <table border='1'>
        <thead>
            <tr>    
                <th>관광지명</th>
                <th>관광지구분</th>
                <th>소재지도로명주소</th>
                <th>소재지지번주소</th>
                <th>위도</th>
                
                <th>경도</th>
                <th>면적</th>
                <th>공공편익시설정보</th>
                <th>숙박시설정보</th>
                <th>운동및오락시설정보</th>
                
                <th>휴양및문화시설정보</th>

            </tr>
        </thead>
        <tbody>
        <% for(Item item: items) { %>
            <tr>
                <td><%= item.getCrowded() %></td>
                <td><%= item.getLowPlate() %></td>
                <td><%= item.getPlateNo() %></td>
                <td><%= item.getRemainSeatCnt() %></td>
                <td><%= item.getRouteId() %></td>
                
                <td><%= item.getRouteTypeCd() %></td>
                <td><%= item.getStateCd() %></td>
                <td><%= item.getStationId() %></td>
                <td><%= item.getStationSeq() %></td>
                <td><%= item.getTaglessCd() %></td>
                
                <td><%= item.getVehId() %></td>
            </tr>
        <% } %>
        </tbody>
    </table>
<% } else { %>
    <p>데이터가 없거나 로드하는 중 오류가 발생했습니다 </p>
<% } %>



</body>
</html>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ page import="openapi.*, openapi.ApiDataDTO.*, java.util.List" %>
<%
    // 로직 구현
    List<Item> itemList = null;
    
    String serviceKey = "azuwE8nDzBbDI%2B2BHA9LYLCpF7ePjarJFg7tcbHh4zmHPfB2wSM16DNtPwCQAW%2FvIFn94C%2FUoMNeh1dbu4dnJg%3D%3D";
    String srcUrl = "http://apis.data.go.kr/1320000/PlanCrossRoadInfoService/getPlanCRHDInfo";
    
    try {
        Class<ApiDataDTO> dto = ApiDataDTO.class;
        ApiDataDTO data = (ApiDataDTO)ApiExplorer.getApiJsonData(serviceKey, srcUrl, dto);
        
        if (data.getItemList() != null && data.getItemList().size() > 0) {
            itemList = data.getItemList();
        }
    } catch(Exception e) {
        System.out.println(e.getMessage());
    }
    
    
%>    
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>공공 데이터</title>
</head>
<body>
<% if (itemList != null && !itemList.isEmpty()) { %>
    <table>
        <thead>
            <tr>
                <th>지역 코드</th>
                <th>계획 번호</th>
                <th>계획 일</th>
                <th>교차로 번호</th>
                <th>계획 월</th>
                <th>교차로 이름</th>
                <th>수집 일시</th>
                <th>계획 일련번호</th>
            </tr>
        </thead>
        <tbody>
            <% for(Item item: itemList) { %>
            <tr>
                <td><%= item.getRegionCd() %></td>
                <td><%= item.getIntPlanNo() %></td>
                <td><%= item.getHolyPlanDd() %></td>
                <td><%= item.getIntNo() %></td>
                <td><%= item.getHolyPlanMm() %></td>
                <td><%= item.getIntNm() %></td>
                <td><%= item.getCollctDtime() %></td>
                <td><%= item.getPlanSn() %></td>
            </tr>
            <% } %>
        </tbody>
    </table>
<% } %>
</body>
</html>